# ğŸ“˜ ê°€ì´ë“œ_11_ìµœëª…í—Œ_ê²Œì‹œíŒ (ì‹¬í™”)

> **ìƒíƒœ ì§„ë‹¨**: í˜„ì¬ `BoardDAO`ì˜ ì¡°íšŒ ì¿¼ë¦¬ê°€ ì˜ëª»ë˜ì–´ ìˆìŠµë‹ˆë‹¤(JOIN ëˆ„ë½). ë˜í•œ `BoardWriteAction`ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.
> **ëª©í‘œ**: ì‘ì„±ì ì´ë¦„ì´ ì œëŒ€ë¡œ ë‚˜ì˜¤ë„ë¡ **DAO ì¿¼ë¦¬ ìˆ˜ì •**í•˜ê³ , **ê¸€ì“°ê¸° ê¸°ëŠ¥** ì™„ì„±í•˜ê¸°

---

## 1. ğŸš¨ `BoardDAO.java` ê¸´ê¸‰ ìˆ˜ì • (ê°€ì¥ ì¤‘ìš”!)

í˜„ì¬ `selectAllBoards` ë©”ì„œë“œë¥¼ ë³´ë©´ `select * from board`ë¼ê³ ë§Œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
ì´ë ‡ê²Œ í•˜ë©´ í™”ë©´ì— ì‘ì„±ì ì´ë¦„ ëŒ€ì‹  **ì•„ì´ë””(writer)**ë§Œ ë‚˜ì˜¤ê±°ë‚˜, ì´ë¦„ì´ ì•„ì˜ˆ ì•ˆ ë‚˜ì˜µë‹ˆë‹¤.

**ë°˜ë“œì‹œ ì•„ë˜ ì½”ë“œë¡œ ìˆ˜ì •í•´ì£¼ì„¸ìš”.** (`members` í…Œì´ë¸”ê³¼ ì¡°ì¸)

### `src/main/java/com/saeyan/dao/BoardDAO.java`

```java
public List<BoardVO> selectAllBoards() {
    Connection con = null;
    PreparedStatement pstmt = null;
    ResultSet rs = null;

    // âŒ ê¸°ì¡´: String sql = "select * from board order by seq desc";
    
    // âœ… ìˆ˜ì •: members í…Œì´ë¸”ê³¼ ì¡°ì¸í•˜ì—¬ ì´ë¦„(name)ì„ ê°€ì ¸ì™€ì•¼ í•¨
    String sql = "select b.*, m.name as writer_name " +
                 "from board b join members m on b.writer = m.id " +
                 "order by seq desc";
                 
    List<BoardVO> list = new ArrayList<BoardVO>();

    try {
        con = DBManager.getConnection();
        pstmt = con.prepareStatement(sql);
        rs = pstmt.executeQuery();

        while (rs.next()) {
            BoardVO vo = new BoardVO();
            vo.setSeq(rs.getInt("seq"));
            vo.setWriter(rs.getString("writer")); // ì•„ì´ë””
            vo.setTitle(rs.getString("title"));
            vo.setContent(rs.getString("content"));
            vo.setHit(rs.getInt("hit"));
            vo.setRegdate(rs.getTimestamp("regdate"));
            
            // âš ï¸ ì¤‘ìš”: BoardVOì— 'writerName' í•„ë“œê°€ ì—†ë‹¤ë©´?
            // ë°©ë²• 1: BoardVOì— private String writerName; í•„ë“œ ì¶”ê°€ (ê¶Œì¥)
            // ë°©ë²• 2: ì„ì‹œë¡œ writer í•„ë“œì— ì´ë¦„ì„ ë®ì–´ì“°ê¸° (ë¹„ì¶”ì²œ) -> vo.setWriter(rs.getString("writer_name"));
            
            // ì—¬ê¸°ì„œëŠ” ë°©ë²• 1ì„ ê°€ì •í•©ë‹ˆë‹¤. BoardVOì— í•„ë“œë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”!
            // vo.setWriterName(rs.getString("writer_name")); 
            
            list.add(vo);
        }
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
        DBManager.close(con, pstmt, rs);
    }
    return list;
}
```

> **[ìˆ™ì œ] BoardVOì— í•„ë“œ ì¶”ê°€í•˜ê¸°**
> `src/main/java/com/saeyan/dto/BoardVO.java`ì— ê°€ì„œ
> `private String writerName;` ì„ ì¶”ê°€í•˜ê³  Getter/Setterë¥¼ ë§Œë“œì„¸ìš”.

---

## 2. ğŸš¨ `BoardWriteAction.java` êµ¬í˜„ (í˜„ì¬ ë¹„ì–´ìˆìŒ!)

`src/main/java/com/saeyan/controller/action/board/BoardWriteAction.java`ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.
ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì•„ì´ë””ë¥¼ ì„¸ì…˜ì—ì„œ êº¼ë‚´ì„œ ì €ì¥í•´ì•¼ í•©ë‹ˆë‹¤.

```java
package com.saeyan.controller.action.board;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import com.saeyan.controller.action.Action;
import com.saeyan.dao.BoardDAO;
import com.saeyan.dto.BoardVO;

public class BoardWriteAction implements Action {

    @Override
    public String execute(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
            
        HttpSession session = request.getSession();
        String userId = (String) session.getAttribute("userId");
        
        // ë¡œê·¸ì¸ ì•ˆ í–ˆìœ¼ë©´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ
        if(userId == null) {
            return "redirect:MemberServlet?command=login_form";
        }

        BoardVO vo = new BoardVO();
        vo.setWriter(userId); // âœ… ì„¸ì…˜ì—ì„œ ê°€ì ¸ì˜¨ ì•„ì´ë”” ì €ì¥
        vo.setTitle(request.getParameter("title"));
        vo.setContent(request.getParameter("content"));

        BoardDAO dao = BoardDAO.getInstance();
        dao.insertBoard(vo);

        return "redirect:BoardServlet?command=board_list";
    }
}
```

---

## 3. ğŸ› ï¸ `boardView.jsp` ê¶Œí•œ ì²´í¬

ìƒì„¸ë³´ê¸° í˜ì´ì§€ì—ì„œ **ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼**ì€ ì•„ë¬´ì—ê²Œë‚˜ ë³´ì—¬ì£¼ë©´ ì•ˆ ë©ë‹ˆë‹¤.

```jsp
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<!-- ... ë‚´ìš© í‘œì‹œ ... -->

<div class="btn-group">
    <input type="button" value="ëª©ë¡" onclick="location.href='BoardServlet?command=board_list'">
    
    <!-- âœ… ê¶Œí•œ ì²´í¬: ë‚´ ê¸€ì´ê±°ë‚˜(userId == board.writer) ê´€ë¦¬ì(ADMIN)ì¼ ë•Œë§Œ -->
    <c:if test="${sessionScope.userId == board.writer || sessionScope.userRole == 'ADMIN'}">
        <input type="button" value="ìˆ˜ì •" onclick="location.href='BoardServlet?command=board_update_form&seq=${board.seq}'">
        <input type="button" value="ì‚­ì œ" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?') && (location.href='BoardServlet?command=board_delete&seq=${board.seq}')">
    </c:if>
</div>
```

ëª…í—Œë‹˜ íŒŒíŠ¸ê°€ ê°€ì¥ ì¤‘ìš”í•©ë‹ˆë‹¤. **JOIN ì¿¼ë¦¬**ê°€ ì—†ìœ¼ë©´ ê²Œì‹œíŒ ëª©ë¡ì— ì´ë¦„ì´ ì•ˆ ë‚˜ì˜µë‹ˆë‹¤. ê¼­ ìˆ˜ì •í•´ì£¼ì„¸ìš”!
