# 준비 파일 검토 및 조정 가이드

> **목적:** daechul-project/board-project에 있는 준비 파일들이 회원 연동 통합 프로젝트에 적합한지 검토하고 필요한 조정사항을 정리합니다.

---

## 📋 현재 파일 현황

### ✅ 적절한 파일 (유지 권장)

#### 1. Common 파일 (공통)

**✅ `common/checkLogin.jsp`** - **완벽합니다!**
```jsp
// 로그인 체크 공통 파일
// 세션에서 userId 확인하여 로그인 여부 체크
```
**판정:** 통합 프로젝트에 필수적인 파일입니다. **그대로 유지**하세요.

**활용 예시:**
```jsp
<%-- 모든 보호된 페이지 상단에 추가 --%>
<%@ include file="../common/checkLogin.jsp" %>
```

---

**✅ `common/checkAdmin.jsp`** (있다면)
- 관리자 권한 체크용
- 상품관리, 관리자 페이지에 필요

---

#### 2. Member 파일 (회원 관리)

이미 회원 연동 준비가 완료되어 있는 것으로 보입니다:
- `member/login.jsp` - 로그인 페이지
- `member/join.jsp` - 회원가입
- `member/memberUpdate.jsp` - 회원정보 수정

**판정:** **그대로 유지**

---

#### 3. Admin 파일 (관리자 페이지)

- `admin/adminMain.jsp` - 관리자 메인
- `admin/member/memberList.jsp` - 회원 관리
- `admin/board/boardManage.jsp` - 게시판 관리

**판정:** **그대로 유지**

---

### ⚠️ 조정 필요한 파일

#### 1. 개발 도구 파일

**⚠️ `test/testLogin.jsp`** - **개발 완료 시 삭제**

**현재 상태:**
```jsp
<!-- 임시 로그인 페이지 (개발용) -->
<!-- 일반 회원 또는 관리자로 빠르게 세션 설정 -->
```

**언제 삭제하나요?**
```
❌ 삭제 시점: 로그인 기능 완성 후
✅ 유지 조건: 개발 진행 중

현재 상황:
- web-study-09 완성 → 로그인 기능 있음
- 따라서 testLogin.jsp 삭제 고려
```

**권장 사항:**

**옵션 1: 즉시 삭제** (권장)
```bash
# 로그인 기능이 이미 있으므로
rm -rf board-project/src/main/webapp/test/
```

**옵션 2: 당분간 유지**
```
이유: 빠른 테스트를 위해 임시로 유지
단, 배포 전에는 반드시 삭제
```

---

**⚠️ `common/devMode.jsp`** - **프로덕션 모드로 변경 필요**

**현재 설정:**
```jsp
<%!
    public static final boolean DEV_MODE = true;  // ← 현재 개발 모드
%>
```

**언제 변경하나요?**

| 상황 | DEV_MODE 설정 |
|------|-------------|
| 개발 중 (로그인 미완성) | `true` ← 더미 데이터 사용 |
| 로그인 완성 후 | `false` ← 실제 세션 사용 |
| 배포 준비 중 | `false` + 파일 삭제 고려 |

**현재 상황 판단:**
```
web-study-09 완성 → 로그인 기능 있음
→ DEV_MODE = false로 변경 권장
```

**변경 방법:**
```jsp
<%!
    Public static final boolean DEV_MODE = false;  // ← 실제 모드로 변경!
%>
```

**또는 완전 삭제:**
```bash
# devMode.jsp를 사용하는 모든 페이지에서
# <%@ include file="../common/devMode.jsp" %> 제거
rm board-project/src/main/webapp/common/devMode.jsp
```

---

#### 2. Board 파일 (게시판)

**⚠️ `board/boardWrite.jsp`** - **세션 정보 추가 필요**

**현재 상태:**
```jsp
<form action="../BoardServlet?command=board_write" method="post">
    <input type="text" name="title" required>
    <textarea name="content" required></textarea>
</form>
```

**문제점:** ❌ 작성자 정보가 없음!

**통합 프로젝트에 필요한 수정:**

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%-- 로그인 체크 --%>
<%@ include file="../common/checkLogin.jsp" %>

<%
    // 세션에서 로그인 정보 가져오기
    String userId = (String) session.getAttribute("userId");
    String userName = (String) session.getAttribute("userName");
%>

<form action="../BoardServlet?command=board_write" method="post">
    <%-- 작성자 정보 숨김 필드로 전송 --%>
    <input type="hidden" name="writer" value="<%= userId %>">
    
    <%-- 작성자 표시 (수정 불가) --%>
    <div class="form-group">
        <label>작성자:</label>
        <span><%= userName %></span>
    </div>
    
    <div class="form-group">
        <label>제목:</label>
        <input type="text" name="title" required>
    </div>
    
    <div class="form-group">
        <label>내용:</label>
        <textarea name="content" rows="10" required></textarea>
    </div>
    
    <div class="form-group">
        <button type="submit">등록</button>
        <button type="button" onclick="history.back()">취소</button>
    </div>
</form>
```

**핵심 추가사항:**
1. ✅ `<%@ include file="../common/checkLogin.jsp" %>` - 로그인 체크
2. ✅ `<input type="hidden" name="writer" value="<%= userId %>">` - 작성자 자동 설정
3. ✅ 작성자 이름 표시 (읽기 전용)

---

**⚠️ `board/boardView.jsp`** - **권한 체크 추가 필요**

**추가 필요사항:**
```jsp
<%@ include file="../common/checkLogin.jsp" %>

<%
    String sessionUserId = (String) session.getAttribute("userId");
    String sessionUserRole = (String) session.getAttribute("userRole");
    
    // 권한 체크: 작성자 본인이거나 관리자
    String boardWriter = board.getWriter();  // board는 request에서 가져온 객체
    boolean canEdit = sessionUserId.equals(boardWriter) || 
                      "ADMIN".equals(sessionUserRole);
%>

<!-- 권한이 있을 때만 수정/삭제 버튼 표시 -->
<% if (canEdit) { %>
    <button onclick="location.href='../BoardServlet?command=board_update_form&seq=${board.seq}'">수정</button>
    <button onclick="if(confirm('정말 삭제하시겠습니까?')) location.href='../BoardServlet?command=board_delete&seq=${board.seq}'">삭제</button>
<% } %>
```

---

### ❌ 삭제해야 할 파일 (web-study-11 잔재)

만약 프로젝트에 다음 파일들이 있다면 삭제해야 합니다:

```bash
# 비밀번호 기반 게시판 파일 (web-study-11에서 가져온 것)
rm board-project/src/main/webapp/board/boardCheckPass.jsp      # 비밀번호 확인 팝업
rm board-project/src/main/webapp/board/checkSuccess.jsp       # 비밀번호 확인 성공
```

**삭제 이유:**
- 통합 프로젝트는 **세션 기반 권한 관리** 사용
- 비밀번호 확인 팝업 불필요
- `checkLogin.jsp`와 세션 체크로 대체

---

## 📊 종합 판정표

| 파일/폴더 | 상태 | 조치 사항 | 우선순위 |
|----------|------|-----------|---------|
| `test/testLogin.jsp` | ⚠️ 개발용 | 배포 전 삭제 | 낮음 |
| `test/testLoginProcess.jsp` | ⚠️ 개발용 | 배포 전 삭제 | 낮음 |
| `common/devMode.jsp` | ⚠️ 설정 필요 | `DEV_MODE = false`로 변경 | **높음** |
| `common/checkLogin.jsp` | ✅ 완벽 | 유지 | - |
| `common/checkAdmin.jsp` | ✅ 완벽 | 유지 | - |
| `board/boardWrite.jsp` | ⚠️ 수정 필요 | writer 필드 추가 | **높음** |
| `board/boardView.jsp` | ⚠️ 수정 필요 | 권한 체크 추가 | **높음** |
| `board/boardList.jsp` | ⚠️ 확인 필요 | 수정/삭제 버튼 권한 체크 | 중간 |
| `board/boardCheckPass.jsp` | ❌ 삭제 | 즉시 삭제 | **높음** |
| `board/checkSuccess.jsp` | ❌ 삭제 | 즉시 삭제 | **높음** |
| `member/*` | ✅ 완벽 | 유지 | - |
| `admin/*` | ✅ 완벽 | 유지 | - |

---

## 🔧 즉시 조치 사항 (우선순위 높음)

### 1. devMode.jsp 설정 변경

```bash
# 파일 열기
vi board-project/src/main/webapp/common/devMode.jsp

# 또는 직접 수정
```

```jsp
<%!
    // false로 변경!
    public static final boolean DEV_MODE = false;
%>
```

---

### 2. 비밀번호 기반 파일 삭제 (있다면)

```bash
# 확인
ls board-project/src/main/webapp/board/ | grep -i "check"

# 삭제 (있다면)
rm board-project/src/main/webapp/board/boardCheckPass.jsp
rm board-project/src/main/webapp/board/checkSuccess.jsp
```

---

### 3. boardWrite.jsp 수정

현재 파일을 다음과 같이 수정:

```jsp
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ include file="../common/checkLogin.jsp" %>  <%-- 추가 --%>
<%
    String userId = (String) session.getAttribute("userId");
    String userName = (String) session.getAttribute("userName");
%>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>게시글 작성</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="container">
        <h2>게시글 작성</h2>
        
        <form action="../BoardServlet?command=board_write" method="post">
            <%-- 작성자 정보 추가 --%>
            <input type="hidden" name="writer" value="<%= userId %>">
            
            <div class="form-group">
                <label>작성자:</label>
                <span class="read-only"><%= userName %></span>
            </div>
            
            <div class="form-group">
                <label>제목:</label>
                <input type="text" name="title" required>
            </div>
            
            <div class="form-group">
                <label>내용:</label>
                <textarea name="content" rows="10" required></textarea>
            </div>
            
            <div class="form-group">
                <button type="submit">등록</button>
                <button type="button" onclick="history.back()">취소</button>
            </div>
        </form>
    </div>
</body>
</html>
```

---

### 4. boardView.jsp 확인 및 권한 체크 추가

파일을 열어 권한 체크 로직이 있는지 확인하고, 없으면 추가합니다.

---

## 📝 배포 전 최종 체크리스트

- [ ] `test/` 폴더 전체 삭제
- [ ] `common/devMode.jsp` 삭제 또는 `DEV_MODE = false`
- [ ] `board/boardCheckPass.jsp` 삭제
- [ ] `board/checkSuccess.jsp` 삭제
- [ ] 모든 보호된 페이지에 `checkLogin.jsp` include 확인
- [ ] 게시판 작성/수정/삭제에 권한 체크 확인
- [ ] 관리자 페이지에 `checkAdmin.jsp` 확인

---

## 💡 권장 작업 순서

1. **지금 당장 (개발 중):**
   - `common/devMode.jsp` → `DEV_MODE = false` 변경
   - `board/boardWrite.jsp` → writer 필드 추가
   - 비밀번호 기반 파일 삭제 (있다면)

2. **기능 테스트 시:**
   - `test/testLogin.jsp` 활용 (빠른 테스트용)
   - 실제 로그인도 병행 테스트

3. **배포 준비 단계:**
   - `test/` 폴더 전체 삭제
   - `common/devMode.jsp` 삭제
   - 모든 체크리스트 확인

---

## 🎯 결론

**현재 상태 평가:**
- ✅ 기본 구조는 잘 준비되어 있음
- ⚠️ 일부 개발용 파일 정리 필요
- ⚠️ board 파일들에 세션 연동 추가 필요

**즉시 조치:**
1. `devMode.jsp` 설정 변경
2. `boardWrite.jsp` 수정
3. 비밀번호 기반 파일 삭제

**당분간 유지 가능:**
- `test/testLogin.jsp` (빠른 테스트용)
- 단, 배포 전 반드시 삭제!
